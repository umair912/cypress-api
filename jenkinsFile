pipeline {
    agent any
    environment:{
        CI = 'true'
    }
    stages('Run tests and their setup'){
        steps {
        sh '''#!/bin/bash +x
          set -o errexit

          curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash
          source ~/.nvm/nvm.sh
          nvm install 14.0.0
          npm install
          npm run test
        '''
      }
    }
}